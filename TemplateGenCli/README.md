# TemplateGenCli

> æ­¤é¡¹ç›®ä»£ç ç”±AIååŠ©å¼€å‘å®Œæˆ | This project was developed with AI assistance

ä¸€ä¸ªåŸºäºå®ä½“ç±»çš„C#ä»£ç ç”Ÿæˆå™¨CLIå·¥å…·ï¼Œè‡ªåŠ¨ç”ŸæˆRepositoryã€Serviceã€Mapsteré…ç½®ç­‰æ¨¡æ¿ä»£ç ï¼Œå‡å°‘é‡å¤æ€§å·¥ä½œå’Œæ‰‹åŠ¨æ–‡ä»¶æ“ä½œã€‚

A C# CLI code generator tool based on entity classes that automatically generates Repository, Service, Mapster configuration template code, reducing repetitive work and manual file operations.

---

## åŠŸèƒ½ç‰¹æ€§ | Features

- ğŸš€ **è‡ªåŠ¨ä»£ç ç”Ÿæˆ | Auto Code Generation** - åŸºäºå®ä½“ç±»è‡ªåŠ¨ç”ŸæˆRepositoryã€Serviceã€Mapsteré…ç½® | Automatically generate Repository, Service, Mapster configurations based on entity classes
- âš™ï¸ **é…ç½®é©±åŠ¨ | Configuration Driven** - é€šè¿‡appsettings.jsonçµæ´»é…ç½®ç”Ÿæˆè§„åˆ™ | Flexible generation rules via appsettings.json
- ğŸ—ï¸ **å¯æ‰©å±•æ¶æ„ | Extensible Architecture** - æ”¯æŒæ·»åŠ æ–°çš„ä»£ç ç”Ÿæˆå™¨ç±»å‹ | Support for adding new code generator types
- ğŸ“ **æ‰¹é‡å¤„ç† | Batch Processing** - ä¸€æ¬¡æ€§å¤„ç†æ•´ä¸ªå®ä½“æ–‡ä»¶å¤¹ | Process entire entity folders at once
- ğŸ”§ **ä¾èµ–æ³¨å…¥é›†æˆ | DI Integration** - è‡ªåŠ¨æ³¨å…¥ç”Ÿæˆçš„ç±»åˆ°DIå®¹å™¨ | Automatically inject generated classes into DI container

## æ”¯æŒçš„ç”Ÿæˆå™¨ç±»å‹ | Supported Generator Types

1. **Mapsteré…ç½®ç”Ÿæˆå™¨ | Mapster Config Generator** - ç”ŸæˆTypeAdapteræ˜ å°„é…ç½® | Generate TypeAdapter mapping configurations
2. **Repositoryç”Ÿæˆå™¨ | Repository Generator** - ç”Ÿæˆä»“å‚¨æ¥å£å’Œå®ç° | Generate repository interfaces and implementations
3. **Serviceç”Ÿæˆå™¨ | Service Generator** - ç”ŸæˆæœåŠ¡æ¥å£å’Œå®ç° | Generate service interfaces and implementations

---

## å¿«é€Ÿå¼€å§‹ | Quick Start

### 1. å‘å¸ƒå·¥å…·åˆ°é¡¹ç›® | Deploy Tool to Project

```bash
# å°†TemplateGenCli.exeå¤åˆ¶åˆ°ä½ çš„é¡¹ç›®æ ¹ç›®å½•
# Copy TemplateGenCli.exe to your project root directory
```

### 2. é…ç½®appsettings.json | Configure appsettings.json

```json
{
    "CodeGenConfig": {
        "entityConfig": {
            "path": "..\\..\\Entities",
            "namespace": "YourProject.Entities",
            "exceptEntities": ["Log", "Audit"]
        },
        "mapsterConfig": {
            "enable": true,
            "namespace": "YourProject.Mappings",
            "configFile": "Config\\MapsterConfig.cs",
            "outputPath": "Generated\\Mappings",
            "startMark": "// <auto-generated start>",
            "endMark": "// <auto-generated end>"
        },
        "serviceConfig": {
            "enable": true,
            "outputPath": "Generated\\Services",
            "namespace": "YourProject.Services",
            "interfaceOutput": "Interfaces\\Services",
            "interfaceNamespace": "YourProject.Interfaces.Services",
            "startMark": "// <service-injection start>",
            "endMark": "// <service-injection end>",
            "diFilePath": "Config\\ServiceRegistration.cs"
        },
        "repositoryConfig": {
            "enable": true,
            "outputPath": "Generated\\Repositories",
            "namespace": "YourProject.Repositories",
            "persistenceNamespace": "YourProject.Data",
            "dbContext": "AppDbContext",
            "interfaceOutput": "Interfaces\\Repositories",
            "interfaceNamespace": "YourProject.Interfaces.Repositories",
            "startMark": "// <repository-injection start>",
            "endMark": "// <repository-injection end>",
            "diFilePath": "Config\\RepositoryRegistration.cs"
        }
    }
}
```

### 3. è¿è¡Œç”Ÿæˆå™¨ | Run Generator

```bash
./TemplateGenCli.exe
```

---

## é…ç½®è¯¦è§£ | Configuration Details

### EntityConfig
- **path** - å®ä½“ç±»æ–‡ä»¶è·¯å¾„ | Entity class file path
- **namespace** - å®ä½“ç±»å‘½åç©ºé—´ | Entity class namespace
- **exceptEntities** - æ’é™¤çš„å®ä½“ç±»åç§°åˆ—è¡¨ | List of entity names to exclude

### MapsterConfig
- **enable** - æ˜¯å¦å¯ç”¨Mapsteré…ç½®ç”Ÿæˆ | Whether to enable Mapster config generation
- **namespace** - ç”Ÿæˆçš„Mapsteré…ç½®ç±»å‘½åç©ºé—´ | Namespace for generated Mapster config classes
- **configFile** - Mapsteré…ç½®æ–‡ä»¶è·¯å¾„ï¼ˆç”¨äºæ³¨å…¥ï¼‰ | Mapster config file path (for injection)
- **outputPath** - è¾“å‡ºç›®å½• | Output directory
- **startMark/endMark** - è‡ªåŠ¨ç”Ÿæˆä»£ç çš„æ ‡è®° | Markers for auto-generated code

### ServiceConfig & RepositoryConfig
ç±»ä¼¼ç»“æ„ï¼Œæ”¯æŒæ¥å£å’Œå®ç°çš„åˆ†ç¦»ç”Ÿæˆï¼Œä»¥åŠDIæ³¨å†Œã€‚
Similar structure, supporting separate generation of interfaces and implementations, as well as DI registration.

---

## æ‰©å±•å¼€å‘ | Extension Development

### æ·»åŠ æ–°çš„ç”Ÿæˆå™¨ç±»å‹ | Adding New Generator Types

#### 1. åˆ›å»ºç”Ÿæˆå™¨æšä¸¾ | Create Generator Enum
```csharp
public enum GeneratorType
{
    Repository,
    Service,
    Mapster,
    YourNewGenerator  // æ·»åŠ æ–°ç±»å‹ | Add new type
}
```

#### 2. å®ç°IGeneratoræ¥å£ | Implement IGenerator Interface
```csharp
public class YourNewGenerator : IGenerator
{
    public void Run(IGeneratorConfig config, GeneratorContext context)
    {
        // å®ç°ä½ çš„ç”Ÿæˆé€»è¾‘ | Implement your generation logic
    }
}
```

#### 3. æ›´æ–°å·¥å‚ç±» | Update Factory Class
```csharp
public static IGenerator? Create(GeneratorType type)
{
    return type switch
    {
        GeneratorType.YourNewGenerator => new YourNewGenerator(),
        // ... å…¶ä»–ç±»å‹ | other types
        _ => null
    };
}
```

### GeneratorContextçš„ä½œç”¨ | Role of GeneratorContext

`GeneratorContext`æ˜¯ç”Ÿæˆå™¨ä¹‹é—´å…±äº«æ•°æ®çš„ä¸Šä¸‹æ–‡å¯¹è±¡ï¼š
`GeneratorContext` is a context object for sharing data between generators:

- **EntityConfig** - åŒ…å«å®ä½“é…ç½®ä¿¡æ¯ | Contains entity configuration information
- **å¯æ‰©å±•æ€§ | Extensibility** - å¯æ·»åŠ æ›´å¤šå…±äº«æ•°æ®ï¼ˆå¦‚è§£æçš„å®ä½“å…ƒæ•°æ®ï¼‰ | Can add more shared data (such as parsed entity metadata)

```csharp
public class GeneratorContext
{
    public EntityConfig EntityConfig { get; }
    // å¯ä»¥æ·»åŠ æ›´å¤šå…±äº«æ•°æ® | Can add more shared data
    public Dictionary<string, EntityMetadata> EntityMetadata { get; set; }
    
    public GeneratorContext(EntityConfig entityConfig)
    {
        EntityConfig = entityConfig;
    }
}
```

### CodeGenConfigè¯´æ˜ | CodeGenConfig Description

`CodeGenConfig`æ˜¯ä¸»é…ç½®ç±»ï¼Œé€šè¿‡appsettings.jsonç»‘å®šï¼š
`CodeGenConfig` is the main configuration class, bound through appsettings.json:

```csharp
public class CodeGenConfig
{
    public EntityConfig EntityConfig { get; set; }
    public MapsterConfig MapsterConfig { get; set; }
    public ServiceConfig ServiceConfig { get; set; }
    public RepositoryConfig RepositoryConfig { get; set; }
}
```

---

## æœªæ¥è§„åˆ’ | Future Plans

- [ ] æ”¯æŒæŒ‡å®šå®ä½“ç”Ÿæˆ | Support specific entity generationï¼š`./TemplateGenCli.exe -entity User,Product`
- [ ] æ”¯æŒCRUDæ¨¡æ¿ç”Ÿæˆ | Support CRUD template generation
- [ ] æ”¯æŒè‡ªå®šä¹‰æ¨¡æ¿æ–‡ä»¶ | Support custom template files
- [ ] æ”¯æŒæ›´å¤šORMæ¡†æ¶ | Support more ORM frameworks

## è´¡çŒ®æŒ‡å— | Contributing

æ¬¢è¿æäº¤Pull Requestæ¥ï¼š
Welcome to submit Pull Requests to:

- æ·»åŠ æ–°çš„ç”Ÿæˆå™¨ç±»å‹ | Add new generator types
- æ”¹è¿›ç°æœ‰æ¨¡æ¿ | Improve existing templates  
- æ·»åŠ æ–°åŠŸèƒ½ | Add new features
- ä¿®å¤Bug | Fix bugs

## æ³¨æ„äº‹é¡¹ | Notes

1. ç¡®ä¿å®ä½“ç±»æ–‡ä»¶è·¯å¾„æ­£ç¡® | Ensure entity class file paths are correct
2. ç”Ÿæˆå‰è¯·å¤‡ä»½ç°æœ‰ä»£ç  | Please backup existing code before generation
3. æ£€æŸ¥ç”Ÿæˆçš„ä»£ç æ˜¯å¦ç¬¦åˆé¡¹ç›®è§„èŒƒ | Check if generated code meets project standards
4. æš‚ä¸æ”¯æŒæŒ‡å®šå•ä¸ªå®ä½“ç”Ÿæˆï¼ˆå¯é€šè¿‡æ’é™¤åˆ—è¡¨é—´æ¥å®ç°ï¼‰ | Currently does not support generating specific entities (can be achieved indirectly through exclusion list)

---

*Happy Coding! ğŸš€*